<style>
    .content-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        background-color: #f2f2f2;
        border-bottom: 1px solid #e0e0e0;
    }
    .report-count {
        font-size: 16px;
        font-weight: bold;
        color: #333;
    }
    .new-report {
        font-size: 14px;
        cursor: pointer;
        color: #007BFF;
    }
    .new-report:hover {
        text-decoration: underline;
    }
    .report-table {
        width: 100%;
        border-collapse: collapse;
        margin: 5px 0;
    }
    .report-table tr {
        border-bottom: 1px solid #e0e0e0;
    }
    .report-table tr td {
        padding: 10px;
    }
    .report-name {
        font-weight: bold;
    }
    .report-time {
        color: #888;
        font-size: 12px;
    }
    .action-btn {
        padding: 5px 10px;
        margin-right: 5px;
        border: none;
        color: white;
        cursor: pointer;
        transition: background-color 0.3s;
    }
    .action-btn {
        background-color: #4CAF50;
    }
    .action-btn {
        background-color: #45a049;
    }
</style>

<div class="content" style="max-width:800px">
    <div class="content-header">
        <div class="report-count">{{reports | length}} Reports</div>
        <div class="new-report">New Report</div>
    </div>
    <table class="report-table">
        {% for report in reports %}
            <tr>
                <td><input type="checkbox"></td>
                <td>
                    <span class="report-name">{{ report.title }}</span>
                    <br>
                    <span class="report-time">Created: {{ report.created_at }}</span>
                </td>
                <td style="text-align: right;">
                    <button class="action-btn download">Download</button>
                    <button class="action-btn send">Send</button>
                    <button class="action-btn view">View</button>
                </td>
            </tr>
        {% endfor %}
    </table>
</div>

<script>

    var reports = {{ reports | tojson }};

    // download the report when user clicks download button
    document.querySelectorAll('.action-btn.download').forEach(function(button, index) {
        button.addEventListener('click', function() {
            var pdfPath = reports[index].path;
            var currentPath = window.location.pathname;
            var downloadReportUrl = currentPath + '/download_report/' + pdfPath;
        
            fetch("/p/test/report/download_report/report.pdf ") // By default, this will be a GET request
                .then(response => response.blob())
                .then(blob => {
                    var url = window.URL.createObjectURL(blob);
                    var a = document.createElement('a');
                    a.href = url;
                    a.download = 'report.pdf';
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                });
        });
    });

    document.querySelector('.new-report').addEventListener('click', function() {
        window.location.href = "{{url_for('new_report_form',project_id=project_id)}}"
    });
</script>